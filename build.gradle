apply plugin: 'groovy'
apply plugin: 'codenarc'

version = 0.1

repositories {
	mavenCentral()
}

dependencies {
	compile 'org.codehaus.groovy:groovy-all:2.3.3'
	testCompile 'org.spockframework:spock-core:0.7-groovy-2.0' 
}

codenarc {
	configFile = new File( 'config/codenarc/rules.groovy' )
}

jar {
	// Add all the jars to the jar we're building
	// - seeing by default the JAR standard has no support for embedded jars, we simple extract them
	//   all and include the resulting files (hence the zipTree).
	// - could replace with the oneJar plugin, but I like the simplicity of not needing to.
	from {
		configurations.runtime.collect {
			it.isDirectory() ? it : zipTree(it)
		}
	}
	manifest {
		attributes 'Main-Class': 'vk7is.mhconvert.CLI'
	}
}

jar.dependsOn check, test
